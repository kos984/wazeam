<!DOCTYPE html>
<html>
<head>
<!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script> -->
<script type="text/javascript" src="../js/jquery-1.7.js"></script>
<script type="text/javascript" src="../js/db.jQuery.js"></script>
<script>
	
// request listener
// request = {method:.., data:undefined}
// case getSettingsCartouche return settings
// case saveOprions save option in settings table
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
	/*
	 * request = {method:.., data:undefined}
	 */
	if (!request.method) return;
	
	switch(request.method){
		
		// when my object is initiating I send request for get setting
		// this case return all seting from database 
		case 'getSettingsCartouche':{
			$.db.getOptions(function(settings){
				sendResponse(settings);
			});
		}
		// saving options requst <code>_this.saveOptions({timeCssPosition:$(this).position()});</code>
		case 'saveOprions':{
			if(!request.data) return;
			$.db.setOptions(request.data);
		}
	} // end switch;

});
</script>
</head>
<body>
</body>
</html>
